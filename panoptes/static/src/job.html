{% extends "index.html" %}

{% block main_info %}

<h1>Job {{ job.jobid }}</h1>
<!--Job card-->
<div class="card">
<!--  <div class="card-header"><strong>job info</strong></div>-->
  <table class="informTable table table-responsive-sm table-outline mb-0">
    <thead class="thead-light">
    <tr>
      <th class="text-center">id</th>
      <th class="text-center">rule</th>
      <th class="text-center">wildcards</th>
      <th class="text-center">status</th>
      <th class="text-center">duration</th>
    </tr>
    </thead>
    <tbody>
    <tr>
      <td class="text-center">
      {{ job.jobid }}
      </td>
      <td class="text-center">
        <span class="badge badge-rule">{{ job.name }}</span>
      </td>
      <td>
        {% for wc in job.wildcards.values() %}
        <span class="badge badge-wc">{{ wc }}{% if not loop.last %} {% endif %}</span>
        {% endfor %}
      </td>
      <td class="text-center">
        <span class="badge badge-{{ 'success' if job.status=='Done' else ('danger' if job.status=='Error' else ('info' if job.status=='Running' else 'light text-dark'))}}"> {{ job.status }} </span>
      </td>
      <td class="text-center">
        {{ (job.completed_at-job.started_at)|formatdelta if job.completed_at else '-' }}
      </td>
    </tr>
    </tbody>
  </table>
</div>

<!--Input card-->
<div class="card">
  <div class="card-header">Input</div>
  <table class="table table-responsive-sm table-outline mb-0">
    <tbody>
    {% for in in job.input %}
    <tr>
      <td>
        {{ in }}
      </td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
</div>

<!--Output card-->
<div class="card">
  <div class="card-header">Output</div>
  <table class="table table-responsive-sm table-outline mb-0">
    <tbody>
    {% for out in job.output %}
    <tr>
      <td>
        {{ out }}
      </td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
</div>

<!--Log card-->
<div class="card">
  <div class="card-header">Log</div>
  <table class="table table-responsive-sm table-outline mb-0">
    <tbody>
    {% for logs in job.log %}
    <tr>
      <td>
        {{ logs }}
      </td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
</div>

<!--Log files-->
<div class="card bg-light">
  {% for log in job.log_text %}
  <div class="card-header">{{log.name}}</div>
  <table class="table table-responsive-sm table-outline mb-0">
    <tbody>
    <tr>
      <td>
        <pre class="terminal">
        {{log.text|safe}}
        </pre>
      </td>
    </tr>
    </tbody>
  </table>
  {% endfor %}
</div>

{% endblock %}
